# Full Health

A mod for the game R.E.P.O that restores full health to players at the beginning of each level.

## Description

Your health will be restored every time you spawn in a level, shop or lobby.  
No more buying health packs or using a bug to restore health.  
There are now more options to buy health packs to restore health when injured during the game, rather than to restore
health after the previous level.

## Showcase

| Without mod                                                                                                           | With mod                                                                                                        |
|-----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|
| ![WithoutMod](https://raw.githubusercontent.com/yvsimakov/R.E.P.O_FullHealth/refs/heads/main/showcase/WithoutMod.gif) | ![WithMod](https://raw.githubusercontent.com/yvsimakov/R.E.P.O_FullHealth/refs/heads/main/showcase/WithMod.gif) |

## Features

- Automatically heal all players or yourself at the start of various phases of the game.
- You can also activate heal for all players or yourself even if you are a client in the configuration.
- Works in multiplayer and in single player.
- All features can be changed in the configuration.
- You can set `ToMaxHealthPercentage` value to `x` and set `PhaseMode` to one of `Lobby` or `Level` in configuration to
  always get up to `x`% of max health.
- You can set `ByMaxHealthPercentage` value to `x` and set `PhaseMode` to one of `Lobby` or `Level` in configuration to
  always heal by `x`% of max health.
- You can set `ExactValue` to `x` and set `PhaseMode` to one of `Lobby` or `Level` in configuration to always get healed
  for `x` HP.
- You can set `Expression` to `PlayerMaxHealth*0.3` or anything else using
  the [Expressive](https://github.com/bijington/expressive) library.
- You can set `HealthPackMode` to `All` or other combinations and set `PhaseMode` to one of `Lobby` or `Level` in
  configuration to simulate the health pack bug.
- You can set `HealRequirementMode` to `Survive` then to heal player will need to survive the previous level.

## Installation

1. Install [BepInEx](https://github.com/BepInEx/BepInEx/releases/tag/v5.4.23.2)
2. Place the `FullHealth.dll`, `Expressive.dll` files in the `BepInEx/plugins` folder.
3. Configuration will be generated and can be changed after the first launch of the game at:
   `BepInEx/config/FullHealth.cfg`

## Configuration

| Variable              | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Default |
|-----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|
| Enabled               | Indicates whether the mod is enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | true    |
| ToMaxHealthPercentage | The percentage of the player's maximum health to which he will be healed (Min: 0, Max: 100).<br>Attention! You must set the `PhaseMode` parameter to only one of `Level` or `Lobby`, not both. Otherwise, the healing will be done twice.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 100     |
| ByMaxHealthPercentage | The percentage of the player's maximum health that the player will be healed to (Min: 0, Max: 100).<br>Attention! You must set the `PhaseMode` parameter to only one of `Level` or `Lobby`, not both. Otherwise, the healing will be done twice.<br>It has priority over the `ToMaxHealthPercentage` parameter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 0       |
| ExactValue            | Sets the exact value to heal.<br>Attention! You must set the `PhaseMode` parameter to only one of `Level` or `Lobby`, not both. Otherwise, the healing will be done twice.<br>If the value is `0`, then it is disabled.<br>It has priority over the `ToMaxHealthPercentage` and `ByMaxHealthPercentage` parameters.<br>For example, if you set the value to `15`, you will always receive 15 HP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 0       |
| HealthPackMode        | Sets healing value options to the same as in health packs, one of which will be applied randomly.<br>Attention! You must set the `PhaseMode` parameter to only one of `Level` or `Lobby`, not both. Otherwise, the healing will be done twice.<br>If the value is `None`, then it is disabled.<br>It has priority over the `ToMaxHealthPercentage` and `ByMaxHealthPercentage` and `ExactValue` parameters.<br>For example, if you set the value to `Medium, Large`, you will receive a random healing of 50HP or 100HP.<br>`Small` - heal 25 HP.<br>`Medium` - heal 50 HP.<br>`Large` - heal 100 HP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | None    |
| Expression            | The expression used to calculate the healing value.<br>Attention! You must set the `PhaseMode` parameter to only one of `Level` or `Lobby`, not both. Otherwise, the healing will be done twice.<br>If the value is null or empty or whitespace, then it is disabled.<br>It has priority over the `ToMaxHealthPercentage` and `ByMaxHealthPercentage` and `ExactValue` and `HealthPackMode` parameters.<br>The library used to parse expression is https://github.com/bijington/expressive. You can find detailed information in the documentation.<br>Variables:<br>`[PlayerName]` - player's name.<br>`[PlayerMaxHealth]` - player's maximum health.<br>`[PlayerHealth]` - player's health.<br>`[PlayerSurvived]` - whether the player survived the last round.<br>`[PlayerCount]` - number of players.<br>`[PlayerUpgradeHealth]` - player's upgrade health level.<br>`[PlayerUpgradeStamina]` - player's upgrade stamina level.<br>`[PlayerUpgradeExtraJump]` - player's upgrade extra jump level.<br>`[PlayerUpgradeLaunch]` - player's upgrade launch level.<br>`[PlayerUpgradeMapPlayerCount]` - player's upgrade map player count level.<br>`[PlayerUpgradeSpeed]` - player's upgrade speed level.<br>`[PlayerUpgradeStrength]` - player's upgrade strength level.<br>`[PlayerUpgradeThrow]` - player's upgrade throw level.<br>`[PlayerUpgradeRange]` - player's upgrade range level.<br>Custom functions (Standard functions can be found here https://github.com/bijington/expressive/wiki/Functions):<br>`RandomList(x1, x2, x3...)` - selects a random number from a list. For example, `RandomList(10, 20)` will randomly return `10` or `20`<br>Examples (quotation marks should be removed):<br>`Max((([PlayerMaxHealth]*0.8)-[PlayerHealth]),0)` - same as the `ToMaxHealthPercentage` parameter. The player will be healed to 80% of maximum health.<br>`[PlayerMaxHealth]*0.3` - same as `ByMaxHealthPercentage` parameter. The player will be healed by 30% of maximum health.<br>`40` - same as `ExactValue` parameter. The player will be healed for 40HP.<br>`RandomList(25, 50, 100)` - same as `HealthPackMode` parameter. The player will be randomly healed for 25HP or 50HP or 100HP.<br>`[PlayerMaxHealth] * (If([PlayerCount] <= 2, Random(25, 30), If([PlayerCount] <= 4, Random(35, 40), If([PlayerCount] <= 6, Random(45, 50), Random(55, 60))))/100)` - if there are up to two players, it heals randomly by 25-30 HP. If there are up to four players, it heals randomly by 35-40 HP, and so on. |         |
| WorkMode              | Configures the work mode.<br>Warning: You are using `All` or `Client` values for this parameter at your own risk.<br>It may stop working after future game updates.<br>If another lobby players do not agree with this parameter, do not use it.<br>Also, the incomplete heal may not work correctly with this parameter, since the host or other clients may also perform the heal.<br>`Host` - works only on host.<br>`Client` - works only on client.<br>`All` - works on host and client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Host    |
| HealMode              | Configures the heal mode.<br>`Self` - heal self.<br>`Others` - heal others.<br>`All` - heal all.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | All     |
| PhaseMode             | Configures in which phases of the game health restoration will be triggered.<br>`Level` - when spawning in the level.<br>`Shop` - when spawning in the shop. Attention! Healing in the shop does not affect the game.<br>`Lobby` - when spawning in the truck (not menu) before starting the next level.<br>`Arena` - when spawning in the arena.<br>`All` - in all phases.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | All     |
| HealRequirementMode   | Sets requirements for performing heal.<br>`None` - no requirements.<br>`Survive` - the player must return to the truck at the end of the round and survive.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | None    |

## Additionally

- If you find some bug, or you have a suggestion for improvement, please create
  an [issue](https://github.com/yvsimakov/R.E.P.O_FullHealth/issues).